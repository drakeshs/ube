// ube standard filters
// == javascript image manipulation
// Ian Farrell

ube.addFilters({invert:function(c){for(var b=0,a=c.length;b<a;b+=4){c[b]=255-c[b];c[b+1]=255-c[b+1];c[b+2]=255-c[b+2]}},rgba:function(c,b){for(var a=0;a<4;a++){b[a]=(b[a])?b[a]:0}for(var a=0;a<c.length;a++){c[a]+=b[a%4]}},lighten:function(a,b){b=b[0];this.rgba(a,[b,b,b])},darken:function(a,b){this.lighten(a,[-b[0]])},grayscale:function(d){for(var b=0,a=d.length;b<a;b+=4){var c=Math.round((d[b]+d[b+1]+d[b+2])/3);d[b]=d[b+1]=d[b+2]=c}},sepiatone:function(b,c){var a=(c[0])?(c[0]/100):1;this.grayscale(b);this.rgba(b,[Math.round(94*a),Math.round(38*a),Math.round(18*a)])},monochrome:function(f,g){var e=(Math.pow(2,g[0])-1),b=Math.round(255/e);for(var c=0,a=f.length;c<a;c+=4){var d=(f[c]+f[c+1]+f[c+2])/3;f[c]=f[c+1]=f[c+2]=Math.round(d/b)*b}},replace:function(e,a){var d=a[0],g=[],b=0;for(item in d){var f=item.replace(/ /g,"").split(",");var c=d[item].replace(/ /g,"").split(",");g[b]=[f,c];b++}},threshold:function(d,a){var c=(a[0]+a[1]+a[2]);for(var b=0;b<d.length;b+=4){d[b]=d[b+1]=d[b+2]=((d[b]+d[b+1]+d[b+2])<c)?0:255}},find:function(h,b){var f=b.slice(0,3),c=Math.round(b[3]/100*255)||0;console.log(f,c);for(var g=0,a=h.length;g<a;g+=4){var e=true;for(var d=0;d<3;d++){e=e&&(h[g+d]<=f[d]+c)&&(h[g+d]>=f[d]+c)}h[g]=h[g+1]=h[g+2]=(e)?0:255}},rgbbits:function(d,e){var c=Math.round(255/e[0]);for(var b=0,a=d.length;b<a;b++){if(b%4!=3){d[b]=Math.round(d[b]/c)*c}}},channel:function(e,a){var d=a[0].toLowerCase(),f={r:1,g:2,b:3,a:4};if(f[d[0]]){d=f[d[0]]-1}for(var c=0;c<e.length;c++){var b=c%4;if(b!=d&&(b!=3)){e[c]=0}}},shift:function(h,c){var g=((c[0]<0)?(3-c[0]):c[0])%3,e=(g+1)%3,d=(g+2)%3;for(var f=0,b=h.length;f<b;f+=4){var a=[h[f],h[f+1],h[f+2]];h[f]=a[g];h[f+1]=a[e];h[f+2]=a[d]}},crop:function(b,a,d,c){d.data=b;c.putImageData(d);var d=c.getImageData.apply(c,a);c.canvas.width=a[2];c.canvas.height=a[3];return d},});
